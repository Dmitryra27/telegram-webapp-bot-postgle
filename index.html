<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>AI Chat @AI_DB_PaymentBot </title>
    <link rel="stylesheet" href="static/style.css">
    <link rel="icon" href="static/favicon.ico" />
</head>
<body>
<h1>üí¨ AI Chat - @AI_DB_PaymentBott</h1>
<label for="prompt"></label><textarea id="prompt" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å..."></textarea><br>
<button onclick="send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
<p id="response"></p>

<script src="https://telegram.org/js/telegram-web-app.js "></script>
<script>
    async function send() {
        const prompt = document.getElementById('prompt').value;
        try {
            const userId = Telegram.WebApp.initDataUnsafe.user.id;
            console.log("User ID:", userId);// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å userId
            const res = await fetch(`/api/generate?prompt=${encodeURIComponent(prompt)}&user_id=${userId}`);
            if (res.status === 402) {
                alert("–ü–æ–¥–ø–∏—Å–∫–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å");
                window.location.href = "/subscribe";
            } else {
                document.getElementById('response').innerHTML = await res.text();
            }

        }
        catch (error) {
            console.log("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è User ID:", error);
            document.getElementById('response').innerHTML = '–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram';
        }


    }
</script>
</body>
</html>
